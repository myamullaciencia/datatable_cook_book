

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Py: Tidy data analysis - Friends &#8212; (py)datatable cookbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Python references" href="python_dt_concepts.html" />
    <link rel="prev" title="Py : Tidy data analysis - Global Crop Yields" href="py_dt_global_crop_yields.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/py_datatable_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">(py)datatable cookbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Data Wrangling using py-datatable
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="reference internal" href="ucases.html">
   Exploratory Data Analysis
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="py_seattle_bikes_tidy_data_analysis.html">
     Py: Tidy data analysis - Seattle Bikes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="py_dt_penguins.html">
     Py: Tidy data analysis - Penguins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="py_dt_policia.html">
     Py: Tidy data analysis - Police traffic activity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="py_dt_global_crop_yields.html">
     Py : Tidy data analysis - Global Crop Yields
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Py: Tidy data analysis - Friends
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="python_dt_concepts.html">
   Python references
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SO_faqs.html">
   Frequently Asked Questions
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/py_dt_amigos.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/py_dt_amigos.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/py_dt_amigos.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            
        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="py-tidy-data-analysis-friends">
<h1>Py: Tidy data analysis - Friends<a class="headerlink" href="#py-tidy-data-analysis-friends" title="Permalink to this headline">¶</a></h1>
<p>Friends is an American television sitcom, created by David Crane and Marta Kauffman, which aired on NBC from September 22, 1994, to May 6, 2004, lasting ten seasons. With an ensemble cast starring Jennifer Aniston, Courteney Cox, Lisa Kudrow, Matt LeBlanc, Matthew Perry and David Schwimmer, the show revolves around six friends in their 20s and 30s who live in Manhattan, New York City. The series was produced by Bright/Kauffman/Crane Productions, in association with Warner Bros. Television. The original executive producers were Kevin S. Bright, Kauffman, and Crane.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importing libraries</span>
<span class="kn">import</span> <span class="nn">datatable</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">from</span> <span class="nn">datatable</span> <span class="kn">import</span> <span class="n">f</span><span class="p">,</span><span class="n">by</span><span class="p">,</span><span class="n">count</span><span class="p">,</span><span class="n">update</span><span class="p">,</span><span class="n">sort</span><span class="p">,</span><span class="n">join</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type='text/css'>
.datatable table.frame { margin-bottom: 0; }
.datatable table.frame thead { border-bottom: none; }
.datatable table.frame tr.coltypes td {  color: #FFFFFF;  line-height: 6px;  padding: 0 0.5em;}
.datatable .boolean { background: #DDDD99; }
.datatable .object  { background: #565656; }
.datatable .integer { background: #5D9E5D; }
.datatable .float   { background: #4040CC; }
.datatable .string  { background: #CC4040; }
.datatable .row_index {  background: var(--jp-border-color3);  border-right: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  font-size: 9px;}
.datatable .frame tr.coltypes .row_index {  background: var(--jp-border-color0);}
.datatable th:nth-child(2) { padding-left: 12px; }
.datatable .hellipsis {  color: var(--jp-cell-editor-border-color);}
.datatable .vellipsis {  background: var(--jp-layout-color0);  color: var(--jp-cell-editor-border-color);}
.datatable .na {  color: var(--jp-cell-editor-border-color);  font-size: 80%;}
.datatable .footer { font-size: 9px; }
.datatable .frame_dimensions {  background: var(--jp-border-color3);  border-top: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  display: inline-block;  opacity: 0.6;  padding: 1px 10px 1px 5px;}
</style>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">head_nrows</span><span class="o">=</span><span class="mi">4</span>
<span class="n">dt</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">tail_nrows</span><span class="o">=</span><span class="mi">4</span>
<span class="n">dt</span><span class="o">.</span><span class="n">init_styles</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type='text/css'>
.datatable table.frame { margin-bottom: 0; }
.datatable table.frame thead { border-bottom: none; }
.datatable table.frame tr.coltypes td {  color: #FFFFFF;  line-height: 6px;  padding: 0 0.5em;}
.datatable .boolean { background: #DDDD99; }
.datatable .object  { background: #565656; }
.datatable .integer { background: #5D9E5D; }
.datatable .float   { background: #4040CC; }
.datatable .string  { background: #CC4040; }
.datatable .row_index {  background: var(--jp-border-color3);  border-right: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  font-size: 9px;}
.datatable .frame tr.coltypes .row_index {  background: var(--jp-border-color0);}
.datatable th:nth-child(2) { padding-left: 12px; }
.datatable .hellipsis {  color: var(--jp-cell-editor-border-color);}
.datatable .vellipsis {  background: var(--jp-layout-color0);  color: var(--jp-cell-editor-border-color);}
.datatable .na {  color: var(--jp-cell-editor-border-color);  font-size: 80%;}
.datatable .footer { font-size: 9px; }
.datatable .frame_dimensions {  background: var(--jp-border-color3);  border-top: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  display: inline-block;  opacity: 0.6;  padding: 1px 10px 1px 5px;}
</style>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importign data</span>
<span class="n">amigos_info_dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">fread</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-08/friends_info.csv&#39;</span><span class="p">)</span>
<span class="n">amigos_dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">fread</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-08/friends.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Glance</span>
<span class="n">amigos_info_dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>episode</th><th>title</th><th>directed_by</th><th>written_by</th><th>air_date</th><th>us_views_millions</th><th>imdb_rating</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>2</td><td>The One with the Sonogram at the End</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-29</td><td>20.2</td><td>8.1</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>3</td><td>The One with the Thumb</td><td>James Burrows</td><td>Jeffrey Astrof &amp; Mike Sikowitz</td><td>1994-10-06</td><td>19.5</td><td>8.2</td></tr>
    <tr><td class='row_index'>3</td><td>1</td><td>4</td><td>The One with George Stephanopoulos</td><td>James Burrows</td><td>Alexa Junge</td><td>1994-10-13</td><td>19.7</td><td>8.1</td></tr>
    <tr><td class='row_index'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td></tr>
    <tr><td class='row_index'>232</td><td>10</td><td>15</td><td>The One Where Estelle Dies</td><td>Gary Halvorson</td><td>Story by : Mark KunerthTeleplay by : David Crane &amp;&#133;</td><td>2004-04-22</td><td>22.64</td><td>8.5</td></tr>
    <tr><td class='row_index'>233</td><td>10</td><td>16</td><td>The One with Rachel's Going Away Party</td><td>Gary Halvorson</td><td>Andrew Reich &amp; Ted Cohen</td><td>2004-04-29</td><td>24.51</td><td>8.9</td></tr>
    <tr><td class='row_index'>234</td><td>10</td><td>17</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td></tr>
    <tr><td class='row_index'>235</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>236 rows &times; 8 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seasons</span>
<span class="n">amigos_info_dt</span><span class="p">[:,</span><span class="n">count</span><span class="p">(),</span><span class="n">by</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">season</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>count</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>24</td></tr>
    <tr><td class='row_index'>1</td><td>2</td><td>24</td></tr>
    <tr><td class='row_index'>2</td><td>3</td><td>25</td></tr>
    <tr><td class='row_index'>3</td><td>4</td><td>24</td></tr>
    <tr><td class='row_index'>4</td><td>5</td><td>24</td></tr>
    <tr><td class='row_index'>5</td><td>6</td><td>25</td></tr>
    <tr><td class='row_index'>6</td><td>7</td><td>24</td></tr>
    <tr><td class='row_index'>7</td><td>8</td><td>24</td></tr>
    <tr><td class='row_index'>8</td><td>9</td><td>24</td></tr>
    <tr><td class='row_index'>9</td><td>10</td><td>18</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>10 rows &times; 2 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unique episodes per a season</span>
<span class="n">amigos_info_dt</span><span class="p">[:,</span><span class="n">count</span><span class="p">(),</span><span class="n">by</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">season</span><span class="p">,</span><span class="n">f</span><span class="o">.</span><span class="n">episode</span><span class="p">)</span>
              <span class="p">][:,{</span><span class="s1">&#39;unique_episodes&#39;</span><span class="p">:</span><span class="n">count</span><span class="p">()},</span><span class="n">by</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">season</span><span class="p">)</span>
               <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>unique_episodes</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>24</td></tr>
    <tr><td class='row_index'>1</td><td>2</td><td>24</td></tr>
    <tr><td class='row_index'>2</td><td>3</td><td>25</td></tr>
    <tr><td class='row_index'>3</td><td>4</td><td>24</td></tr>
    <tr><td class='row_index'>4</td><td>5</td><td>24</td></tr>
    <tr><td class='row_index'>5</td><td>6</td><td>25</td></tr>
    <tr><td class='row_index'>6</td><td>7</td><td>24</td></tr>
    <tr><td class='row_index'>7</td><td>8</td><td>24</td></tr>
    <tr><td class='row_index'>8</td><td>9</td><td>24</td></tr>
    <tr><td class='row_index'>9</td><td>10</td><td>18</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>10 rows &times; 2 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># average views and ratings per season</span>
<span class="n">amigos_info_dt</span><span class="p">[:,</span><span class="n">dt</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]),</span><span class="n">by</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">season</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>us_views_millions</th><th>imdb_rating</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>24.7917</td><td>8.31667</td></tr>
    <tr><td class='row_index'>1</td><td>2</td><td>31.7208</td><td>8.45833</td></tr>
    <tr><td class='row_index'>2</td><td>3</td><td>26.308</td><td>8.408</td></tr>
    <tr><td class='row_index'>3</td><td>4</td><td>24.95</td><td>8.475</td></tr>
    <tr><td class='row_index'>4</td><td>5</td><td>24.7458</td><td>8.6375</td></tr>
    <tr><td class='row_index'>5</td><td>6</td><td>22.616</td><td>8.496</td></tr>
    <tr><td class='row_index'>6</td><td>7</td><td>22.0512</td><td>8.4375</td></tr>
    <tr><td class='row_index'>7</td><td>8</td><td>26.7204</td><td>8.45</td></tr>
    <tr><td class='row_index'>8</td><td>9</td><td>23.9304</td><td>8.30417</td></tr>
    <tr><td class='row_index'>9</td><td>10</td><td>26.1294</td><td>8.68889</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>10 rows &times; 3 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Highest rating title</span>
<span class="n">amigos_info_dt</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">imdb_rating</span><span class="o">==</span><span class="n">dt</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">imdb_rating</span><span class="p">),:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>episode</th><th>title</th><th>directed_by</th><th>written_by</th><th>air_date</th><th>us_views_millions</th><th>imdb_rating</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>5</td><td>14</td><td>The One Where Everybody Finds Out</td><td>Michael Lembeck</td><td>Alexa Junge</td><td>1999-02-11</td><td>27.7</td><td>9.7</td></tr>
    <tr><td class='row_index'>1</td><td>10</td><td>17</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td></tr>
    <tr><td class='row_index'>2</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 8 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lowest rating title</span>
<span class="n">amigos_info_dt</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">imdb_rating</span><span class="o">==</span><span class="n">dt</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">imdb_rating</span><span class="p">),:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>episode</th><th>title</th><th>directed_by</th><th>written_by</th><th>air_date</th><th>us_views_millions</th><th>imdb_rating</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>4</td><td>21</td><td>The One with the Invitation</td><td>Peter Bonerz</td><td>Seth Kurland</td><td>1998-04-23</td><td>21.5</td><td>7.2</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>1 row &times; 8 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Top 2 titles having higher rating per season</span>
<span class="n">amigos_info_dt</span><span class="p">[:</span><span class="mi">2</span><span class="p">,:,</span><span class="n">by</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">season</span><span class="p">),</span><span class="n">sort</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">imdb_rating</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>episode</th><th>title</th><th>directed_by</th><th>written_by</th><th>air_date</th><th>us_views_millions</th><th>imdb_rating</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>7</td><td>The One with the Blackout</td><td>James Burrows</td><td>Jeffrey Astrof &amp; Mike Sikowitz</td><td>1994-11-03</td><td>23.5</td><td>9</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>24</td><td>The One Where Rachel Finds Out</td><td>Kevin S. Bright</td><td>Chris Brown</td><td>1995-05-18</td><td>31.3</td><td>8.9</td></tr>
    <tr><td class='row_index'>2</td><td>2</td><td>14</td><td>The One with the Prom Video</td><td>James Burrows</td><td>Alexa Junge</td><td>1996-02-01</td><td>33.6</td><td>9.4</td></tr>
    <tr><td class='row_index'>3</td><td>2</td><td>7</td><td>The One Where Ross Finds Out</td><td>Peter Bonerz</td><td>Michael Borkow</td><td>1995-11-09</td><td>30.5</td><td>9</td></tr>
    <tr><td class='row_index'>4</td><td>3</td><td>6</td><td>The One with the Flashback</td><td>Peter Bonerz</td><td>David Crane &amp; Marta Kauffman</td><td>1996-10-31</td><td>23.3</td><td>9.1</td></tr>
    <tr><td class='row_index'>5</td><td>3</td><td>16</td><td>The One with the Morning After</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1997-02-20</td><td>28.3</td><td>9.1</td></tr>
    <tr><td class='row_index'>6</td><td>4</td><td>12</td><td>The One with the Embryos</td><td>Kevin S. Bright</td><td>Jill Condon &amp; Amy Toomin</td><td>1998-01-15</td><td>27.1</td><td>9.5</td></tr>
    <tr><td class='row_index'>7</td><td>4</td><td>24</td><td>The One with Ross' Wedding</td><td>Kevin S. Bright</td><td>Michael BorkowStory by : Jill Condon &amp; Amy ToominT&#133;</td><td>1998-05-07</td><td>31.6</td><td>9.2</td></tr>
    <tr><td class='row_index'>8</td><td>5</td><td>14</td><td>The One Where Everybody Finds Out</td><td>Michael Lembeck</td><td>Alexa Junge</td><td>1999-02-11</td><td>27.7</td><td>9.7</td></tr>
    <tr><td class='row_index'>9</td><td>5</td><td>8</td><td>The One with All the Thanksgivings</td><td>Kevin S. Bright</td><td>Gregory S. Malins</td><td>1998-11-19</td><td>23.9</td><td>9.2</td></tr>
    <tr><td class='row_index'>10</td><td>6</td><td>25</td><td>The One with the Proposal</td><td>Kevin S. Bright</td><td>Shana Goldberg-Meehan &amp; Scott SilveriAndrew Reich &#133;</td><td>2000-05-18</td><td>30.7</td><td>9.3</td></tr>
    <tr><td class='row_index'>11</td><td>6</td><td>9</td><td>The One Where Ross Got High</td><td>Kevin S. Bright</td><td>Gregory S. Malins</td><td>1999-11-25</td><td>19.2</td><td>9.2</td></tr>
    <tr><td class='row_index'>12</td><td>7</td><td>24</td><td>The One with Monica and Chandler's Wedding</td><td>Kevin S. Bright</td><td>Gregory S. MalinsMarta Kauffman &amp; David Crane</td><td>2001-05-17</td><td>30.05</td><td>9.2</td></tr>
    <tr><td class='row_index'>13</td><td>7</td><td>6</td><td>The One with the Nap Partners</td><td>Gary Halvorson</td><td>Brian Buckner &amp; Sebastian Jones</td><td>2000-11-09</td><td>22.01</td><td>8.9</td></tr>
    <tr><td class='row_index'>14</td><td>8</td><td>4</td><td>The One with the Videotape</td><td>Kevin S. Bright</td><td>Scott Silveri</td><td>2001-10-18</td><td>25.58</td><td>9.3</td></tr>
    <tr><td class='row_index'>15</td><td>8</td><td>9</td><td>The One with the Rumor</td><td>Gary Halvorson</td><td>Shana Goldberg-Meehan</td><td>2001-11-22</td><td>24.24</td><td>9.3</td></tr>
    <tr><td class='row_index'>16</td><td>9</td><td>8</td><td>The One with Rachel's Other Sister</td><td>Kevin S. Bright</td><td>Shana Goldberg-Meehan</td><td>2002-11-21</td><td>26.76</td><td>8.8</td></tr>
    <tr><td class='row_index'>17</td><td>9</td><td>7</td><td>The One with Ross's Inappropriate Song</td><td>Gary Halvorson</td><td>Robert Carlock</td><td>2002-11-14</td><td>25.35</td><td>8.7</td></tr>
    <tr><td class='row_index'>18</td><td>10</td><td>17</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td></tr>
    <tr><td class='row_index'>19</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>20 rows &times; 8 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># find a title info</span>
<span class="n">amigos_info_dt</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">title</span><span class="o">==</span><span class="s2">&quot;The Last One&quot;</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>episode</th><th>title</th><th>directed_by</th><th>written_by</th><th>air_date</th><th>us_views_millions</th><th>imdb_rating</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>10</td><td>17</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td></tr>
    <tr><td class='row_index'>1</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>2 rows &times; 8 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># select few observations till 235</span>
<span class="n">amigos_info_dt</span><span class="p">[[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mi">235</span><span class="p">)],:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>episode</th><th>title</th><th>directed_by</th><th>written_by</th><th>air_date</th><th>us_views_millions</th><th>imdb_rating</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>2</td><td>The One with the Sonogram at the End</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-29</td><td>20.2</td><td>8.1</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>3</td><td>The One with the Thumb</td><td>James Burrows</td><td>Jeffrey Astrof &amp; Mike Sikowitz</td><td>1994-10-06</td><td>19.5</td><td>8.2</td></tr>
    <tr><td class='row_index'>3</td><td>1</td><td>4</td><td>The One with George Stephanopoulos</td><td>James Burrows</td><td>Alexa Junge</td><td>1994-10-13</td><td>19.7</td><td>8.1</td></tr>
    <tr><td class='row_index'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td></tr>
    <tr><td class='row_index'>231</td><td>10</td><td>14</td><td>The One with Princess Consuela</td><td>Gary Halvorson</td><td>Story by : Robert CarlockTeleplay by : Tracy Reill&#133;</td><td>2004-02-26</td><td>22.83</td><td>8.6</td></tr>
    <tr><td class='row_index'>232</td><td>10</td><td>15</td><td>The One Where Estelle Dies</td><td>Gary Halvorson</td><td>Story by : Mark KunerthTeleplay by : David Crane &amp;&#133;</td><td>2004-04-22</td><td>22.64</td><td>8.5</td></tr>
    <tr><td class='row_index'>233</td><td>10</td><td>16</td><td>The One with Rachel's Going Away Party</td><td>Gary Halvorson</td><td>Andrew Reich &amp; Ted Cohen</td><td>2004-04-29</td><td>24.51</td><td>8.9</td></tr>
    <tr><td class='row_index'>234</td><td>10</td><td>17</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>235 rows &times; 8 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">amigos_info_dt</span><span class="p">[:,[</span><span class="n">f</span><span class="o">.</span><span class="n">season</span><span class="p">,</span><span class="n">f</span><span class="o">.</span><span class="n">episode</span><span class="p">,</span><span class="n">f</span><span class="o">.</span><span class="n">us_views_millions</span><span class="p">]]</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;episode&#39;</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;us_views_millions&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39; Episode and views&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-234904627929463b8fcfde718d8d301f"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-234904627929463b8fcfde718d8d301f") {
      outputDiv = document.getElementById("altair-viz-234904627929463b8fcfde718d8d301f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-cbf859be854523edea9673dbd0ced70a"}, "mark": "point", "encoding": {"x": {"type": "quantitative", "field": "episode"}, "y": {"type": "quantitative", "field": "us_views_millions"}}, "title": " Episode and views", "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-cbf859be854523edea9673dbd0ced70a": [{"season": 1, "episode": 1, "us_views_millions": 21.5}, {"season": 1, "episode": 2, "us_views_millions": 20.2}, {"season": 1, "episode": 3, "us_views_millions": 19.5}, {"season": 1, "episode": 4, "us_views_millions": 19.7}, {"season": 1, "episode": 5, "us_views_millions": 18.6}, {"season": 1, "episode": 6, "us_views_millions": 18.2}, {"season": 1, "episode": 7, "us_views_millions": 23.5}, {"season": 1, "episode": 8, "us_views_millions": 21.1}, {"season": 1, "episode": 9, "us_views_millions": 23.1}, {"season": 1, "episode": 10, "us_views_millions": 19.9}, {"season": 1, "episode": 11, "us_views_millions": 26.6}, {"season": 1, "episode": 12, "us_views_millions": 24.0}, {"season": 1, "episode": 13, "us_views_millions": 25.8}, {"season": 1, "episode": 14, "us_views_millions": 23.8}, {"season": 1, "episode": 15, "us_views_millions": 24.8}, {"season": 1, "episode": 16, "us_views_millions": 26.1}, {"season": 1, "episode": 17, "us_views_millions": 30.5}, {"season": 1, "episode": 18, "us_views_millions": 30.4}, {"season": 1, "episode": 19, "us_views_millions": 29.4}, {"season": 1, "episode": 20, "us_views_millions": 30.0}, {"season": 1, "episode": 21, "us_views_millions": 28.4}, {"season": 1, "episode": 22, "us_views_millions": 29.9}, {"season": 1, "episode": 23, "us_views_millions": 28.7}, {"season": 1, "episode": 24, "us_views_millions": 31.3}, {"season": 2, "episode": 1, "us_views_millions": 32.1}, {"season": 2, "episode": 2, "us_views_millions": 29.8}, {"season": 2, "episode": 3, "us_views_millions": 30.2}, {"season": 2, "episode": 4, "us_views_millions": 28.1}, {"season": 2, "episode": 5, "us_views_millions": 28.3}, {"season": 2, "episode": 6, "us_views_millions": 30.2}, {"season": 2, "episode": 7, "us_views_millions": 30.5}, {"season": 2, "episode": 8, "us_views_millions": 32.9}, {"season": 2, "episode": 9, "us_views_millions": 27.8}, {"season": 2, "episode": 10, "us_views_millions": 32.2}, {"season": 2, "episode": 11, "us_views_millions": 31.6}, {"season": 2, "episode": 12, "us_views_millions": 52.9}, {"season": 2, "episode": 13, "us_views_millions": 52.9}, {"season": 2, "episode": 14, "us_views_millions": 33.6}, {"season": 2, "episode": 15, "us_views_millions": 32.9}, {"season": 2, "episode": 16, "us_views_millions": 31.1}, {"season": 2, "episode": 17, "us_views_millions": 30.2}, {"season": 2, "episode": 18, "us_views_millions": 30.1}, {"season": 2, "episode": 19, "us_views_millions": 31.2}, {"season": 2, "episode": 20, "us_views_millions": 27.4}, {"season": 2, "episode": 21, "us_views_millions": 24.7}, {"season": 2, "episode": 22, "us_views_millions": 25.5}, {"season": 2, "episode": 23, "us_views_millions": 26.1}, {"season": 2, "episode": 24, "us_views_millions": 29.0}, {"season": 3, "episode": 1, "us_views_millions": 26.8}, {"season": 3, "episode": 2, "us_views_millions": 26.7}, {"season": 3, "episode": 3, "us_views_millions": 25.2}, {"season": 3, "episode": 4, "us_views_millions": 26.1}, {"season": 3, "episode": 5, "us_views_millions": 23.3}, {"season": 3, "episode": 6, "us_views_millions": 23.3}, {"season": 3, "episode": 7, "us_views_millions": 27.4}, {"season": 3, "episode": 8, "us_views_millions": 28.7}, {"season": 3, "episode": 9, "us_views_millions": 29.3}, {"season": 3, "episode": 10, "us_views_millions": 25.1}, {"season": 3, "episode": 11, "us_views_millions": 29.8}, {"season": 3, "episode": 12, "us_views_millions": 29.6}, {"season": 3, "episode": 13, "us_views_millions": 28.0}, {"season": 3, "episode": 14, "us_views_millions": 28.9}, {"season": 3, "episode": 15, "us_views_millions": 27.3}, {"season": 3, "episode": 16, "us_views_millions": 28.3}, {"season": 3, "episode": 17, "us_views_millions": 25.8}, {"season": 3, "episode": 18, "us_views_millions": 28.1}, {"season": 3, "episode": 19, "us_views_millions": 23.7}, {"season": 3, "episode": 20, "us_views_millions": 24.4}, {"season": 3, "episode": 21, "us_views_millions": 23.2}, {"season": 3, "episode": 22, "us_views_millions": 22.6}, {"season": 3, "episode": 23, "us_views_millions": 24.2}, {"season": 3, "episode": 24, "us_views_millions": 23.1}, {"season": 3, "episode": 25, "us_views_millions": 28.8}, {"season": 4, "episode": 1, "us_views_millions": 29.4}, {"season": 4, "episode": 2, "us_views_millions": 25.5}, {"season": 4, "episode": 3, "us_views_millions": 24.0}, {"season": 4, "episode": 4, "us_views_millions": 24.3}, {"season": 4, "episode": 5, "us_views_millions": 24.4}, {"season": 4, "episode": 6, "us_views_millions": 25.7}, {"season": 4, "episode": 7, "us_views_millions": 26.4}, {"season": 4, "episode": 8, "us_views_millions": 26.8}, {"season": 4, "episode": 9, "us_views_millions": 23.9}, {"season": 4, "episode": 10, "us_views_millions": 23.2}, {"season": 4, "episode": 11, "us_views_millions": 23.7}, {"season": 4, "episode": 12, "us_views_millions": 27.1}, {"season": 4, "episode": 13, "us_views_millions": 25.3}, {"season": 4, "episode": 14, "us_views_millions": 25.1}, {"season": 4, "episode": 15, "us_views_millions": 24.4}, {"season": 4, "episode": 16, "us_views_millions": 23.1}, {"season": 4, "episode": 17, "us_views_millions": 23.2}, {"season": 4, "episode": 18, "us_views_millions": 21.7}, {"season": 4, "episode": 19, "us_views_millions": 21.8}, {"season": 4, "episode": 20, "us_views_millions": 21.9}, {"season": 4, "episode": 21, "us_views_millions": 21.5}, {"season": 4, "episode": 22, "us_views_millions": 23.2}, {"season": 4, "episode": 23, "us_views_millions": 31.6}, {"season": 4, "episode": 24, "us_views_millions": 31.6}, {"season": 5, "episode": 1, "us_views_millions": 31.1}, {"season": 5, "episode": 2, "us_views_millions": 25.4}, {"season": 5, "episode": 3, "us_views_millions": 26.8}, {"season": 5, "episode": 4, "us_views_millions": 24.1}, {"season": 5, "episode": 5, "us_views_millions": 25.9}, {"season": 5, "episode": 6, "us_views_millions": 25.0}, {"season": 5, "episode": 7, "us_views_millions": 24.4}, {"season": 5, "episode": 8, "us_views_millions": 23.9}, {"season": 5, "episode": 9, "us_views_millions": 23.0}, {"season": 5, "episode": 10, "us_views_millions": 23.7}, {"season": 5, "episode": 11, "us_views_millions": 27.0}, {"season": 5, "episode": 12, "us_views_millions": 24.8}, {"season": 5, "episode": 13, "us_views_millions": 24.9}, {"season": 5, "episode": 14, "us_views_millions": 27.7}, {"season": 5, "episode": 15, "us_views_millions": 29.3}, {"season": 5, "episode": 16, "us_views_millions": 26.0}, {"season": 5, "episode": 17, "us_views_millions": 24.5}, {"season": 5, "episode": 18, "us_views_millions": 21.9}, {"season": 5, "episode": 19, "us_views_millions": 20.9}, {"season": 5, "episode": 20, "us_views_millions": 19.6}, {"season": 5, "episode": 21, "us_views_millions": 20.9}, {"season": 5, "episode": 22, "us_views_millions": 21.3}, {"season": 5, "episode": 23, "us_views_millions": 25.9}, {"season": 5, "episode": 24, "us_views_millions": 25.9}, {"season": 6, "episode": 1, "us_views_millions": 27.7}, {"season": 6, "episode": 2, "us_views_millions": 22.9}, {"season": 6, "episode": 3, "us_views_millions": 21.6}, {"season": 6, "episode": 4, "us_views_millions": 21.1}, {"season": 6, "episode": 5, "us_views_millions": 22.4}, {"season": 6, "episode": 6, "us_views_millions": 23.6}, {"season": 6, "episode": 7, "us_views_millions": 22.7}, {"season": 6, "episode": 8, "us_views_millions": 22.1}, {"season": 6, "episode": 9, "us_views_millions": 19.2}, {"season": 6, "episode": 10, "us_views_millions": 22.4}, {"season": 6, "episode": 11, "us_views_millions": 22.3}, {"season": 6, "episode": 12, "us_views_millions": 22.3}, {"season": 6, "episode": 13, "us_views_millions": 24.1}, {"season": 6, "episode": 14, "us_views_millions": 23.8}, {"season": 6, "episode": 15, "us_views_millions": 20.7}, {"season": 6, "episode": 16, "us_views_millions": 20.7}, {"season": 6, "episode": 17, "us_views_millions": 22.1}, {"season": 6, "episode": 18, "us_views_millions": 20.5}, {"season": 6, "episode": 19, "us_views_millions": 21.5}, {"season": 6, "episode": 20, "us_views_millions": 18.8}, {"season": 6, "episode": 21, "us_views_millions": 20.6}, {"season": 6, "episode": 22, "us_views_millions": 20.0}, {"season": 6, "episode": 23, "us_views_millions": 20.9}, {"season": 6, "episode": 24, "us_views_millions": 30.7}, {"season": 6, "episode": 25, "us_views_millions": 30.7}, {"season": 7, "episode": 1, "us_views_millions": 25.54}, {"season": 7, "episode": 2, "us_views_millions": 27.93}, {"season": 7, "episode": 3, "us_views_millions": 22.7}, {"season": 7, "episode": 4, "us_views_millions": 22.66}, {"season": 7, "episode": 5, "us_views_millions": 24.43}, {"season": 7, "episode": 6, "us_views_millions": 22.01}, {"season": 7, "episode": 7, "us_views_millions": 23.73}, {"season": 7, "episode": 8, "us_views_millions": 16.57}, {"season": 7, "episode": 9, "us_views_millions": 21.08}, {"season": 7, "episode": 10, "us_views_millions": 23.26}, {"season": 7, "episode": 11, "us_views_millions": 24.37}, {"season": 7, "episode": 12, "us_views_millions": 22.86}, {"season": 7, "episode": 13, "us_views_millions": 22.24}, {"season": 7, "episode": 14, "us_views_millions": 22.4}, {"season": 7, "episode": 15, "us_views_millions": 21.75}, {"season": 7, "episode": 16, "us_views_millions": 21.22}, {"season": 7, "episode": 17, "us_views_millions": 20.84}, {"season": 7, "episode": 18, "us_views_millions": 17.81}, {"season": 7, "episode": 19, "us_views_millions": 16.55}, {"season": 7, "episode": 20, "us_views_millions": 16.3}, {"season": 7, "episode": 21, "us_views_millions": 15.65}, {"season": 7, "episode": 22, "us_views_millions": 17.23}, {"season": 7, "episode": 23, "us_views_millions": 30.05}, {"season": 7, "episode": 24, "us_views_millions": 30.05}, {"season": 8, "episode": 1, "us_views_millions": 31.7}, {"season": 8, "episode": 2, "us_views_millions": 30.04}, {"season": 8, "episode": 3, "us_views_millions": 29.2}, {"season": 8, "episode": 4, "us_views_millions": 25.58}, {"season": 8, "episode": 5, "us_views_millions": 25.64}, {"season": 8, "episode": 6, "us_views_millions": 26.96}, {"season": 8, "episode": 7, "us_views_millions": 24.24}, {"season": 8, "episode": 8, "us_views_millions": 26.54}, {"season": 8, "episode": 9, "us_views_millions": 24.24}, {"season": 8, "episode": 10, "us_views_millions": 22.44}, {"season": 8, "episode": 11, "us_views_millions": 23.85}, {"season": 8, "episode": 12, "us_views_millions": 25.53}, {"season": 8, "episode": 13, "us_views_millions": 29.24}, {"season": 8, "episode": 14, "us_views_millions": 28.64}, {"season": 8, "episode": 15, "us_views_millions": 28.64}, {"season": 8, "episode": 16, "us_views_millions": 27.52}, {"season": 8, "episode": 17, "us_views_millions": 26.3}, {"season": 8, "episode": 18, "us_views_millions": 22.05}, {"season": 8, "episode": 19, "us_views_millions": 22.59}, {"season": 8, "episode": 20, "us_views_millions": 22.24}, {"season": 8, "episode": 21, "us_views_millions": 23.97}, {"season": 8, "episode": 22, "us_views_millions": 24.32}, {"season": 8, "episode": 23, "us_views_millions": 34.91}, {"season": 8, "episode": 24, "us_views_millions": 34.91}, {"season": 9, "episode": 1, "us_views_millions": 34.01}, {"season": 9, "episode": 2, "us_views_millions": 28.93}, {"season": 9, "episode": 3, "us_views_millions": 26.63}, {"season": 9, "episode": 4, "us_views_millions": 25.82}, {"season": 9, "episode": 5, "us_views_millions": 24.46}, {"season": 9, "episode": 6, "us_views_millions": 27.51}, {"season": 9, "episode": 7, "us_views_millions": 25.35}, {"season": 9, "episode": 8, "us_views_millions": 26.76}, {"season": 9, "episode": 9, "us_views_millions": 25.43}, {"season": 9, "episode": 10, "us_views_millions": 22.29}, {"season": 9, "episode": 11, "us_views_millions": 23.67}, {"season": 9, "episode": 12, "us_views_millions": 23.66}, {"season": 9, "episode": 13, "us_views_millions": 25.82}, {"season": 9, "episode": 14, "us_views_millions": 23.37}, {"season": 9, "episode": 15, "us_views_millions": 20.85}, {"season": 9, "episode": 16, "us_views_millions": 19.52}, {"season": 9, "episode": 17, "us_views_millions": 21.0}, {"season": 9, "episode": 18, "us_views_millions": 20.79}, {"season": 9, "episode": 19, "us_views_millions": 18.25}, {"season": 9, "episode": 20, "us_views_millions": 20.71}, {"season": 9, "episode": 21, "us_views_millions": 19.03}, {"season": 9, "episode": 22, "us_views_millions": 19.55}, {"season": 9, "episode": 23, "us_views_millions": 25.46}, {"season": 9, "episode": 24, "us_views_millions": 25.46}, {"season": 10, "episode": 1, "us_views_millions": 24.54}, {"season": 10, "episode": 2, "us_views_millions": 22.38}, {"season": 10, "episode": 3, "us_views_millions": 21.87}, {"season": 10, "episode": 4, "us_views_millions": 18.77}, {"season": 10, "episode": 5, "us_views_millions": 19.37}, {"season": 10, "episode": 6, "us_views_millions": 20.38}, {"season": 10, "episode": 7, "us_views_millions": 20.21}, {"season": 10, "episode": 8, "us_views_millions": 20.66}, {"season": 10, "episode": 9, "us_views_millions": 25.49}, {"season": 10, "episode": 10, "us_views_millions": 26.68}, {"season": 10, "episode": 11, "us_views_millions": 24.91}, {"season": 10, "episode": 12, "us_views_millions": 25.9}, {"season": 10, "episode": 13, "us_views_millions": 24.27}, {"season": 10, "episode": 14, "us_views_millions": 22.83}, {"season": 10, "episode": 15, "us_views_millions": 22.64}, {"season": 10, "episode": 16, "us_views_millions": 24.51}, {"season": 10, "episode": 17, "us_views_millions": 52.46}, {"season": 10, "episode": 18, "us_views_millions": 52.46}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Average views and rating per directors</span>
<span class="n">directors_views_rating</span> <span class="o">=</span> <span class="n">amigos_info_dt</span><span class="p">[:,</span><span class="n">dt</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]),</span><span class="n">by</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">directed_by</span><span class="p">)</span>
                                       <span class="p">][:,:,</span><span class="n">dt</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">imdb_rating</span><span class="p">)</span>
                                        <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Top 10 directors who have made more titles</span>
<span class="n">directors_dt</span> <span class="o">=</span> <span class="n">amigos_info_dt</span><span class="p">[:,</span><span class="n">count</span><span class="p">(),</span><span class="n">by</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">directed_by</span><span class="p">)</span>
                             <span class="p">][:</span><span class="mi">10</span><span class="p">,:,</span><span class="n">dt</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                              <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setting a key on DT</span>
<span class="n">directors_dt</span><span class="o">.</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;directed_by&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First 5 and last 5 observations</span>
<span class="n">directors_views_rating</span><span class="p">[[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="nb">slice</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="kc">None</span><span class="p">)],:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>directed_by</th><th>us_views_millions</th><th>imdb_rating</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>Joe Regalbuto</td><td>27</td><td>9.1</td></tr>
    <tr><td class='row_index'>1</td><td>Kevin S. Bright</td><td>27.3308</td><td>8.6566</td></tr>
    <tr><td class='row_index'>2</td><td>Pamela Fryman</td><td>23.7</td><td>8.65</td></tr>
    <tr><td class='row_index'>3</td><td>Andrew Tsao</td><td>26</td><td>8.6</td></tr>
    <tr><td class='row_index'>4</td><td>David Schwimmer</td><td>24.435</td><td>8.55</td></tr>
    <tr><td class='row_index'>5</td><td>Robby Benson</td><td>27.9333</td><td>8.18333</td></tr>
    <tr><td class='row_index'>6</td><td>Arlene Sanford</td><td>18.2</td><td>8.1</td></tr>
    <tr><td class='row_index'>7</td><td>Steve Zuckerman</td><td>24.7</td><td>8.1</td></tr>
    <tr><td class='row_index'>8</td><td>Thomas Schlamme</td><td>31.9</td><td>8.05</td></tr>
    <tr><td class='row_index'>9</td><td>Todd Holland</td><td>21.9</td><td>8</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>10 rows &times; 3 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># directors and their avg title rating and total titles</span>
<span class="n">directors_views_rating_v1</span> <span class="o">=</span> <span class="n">directors_views_rating</span><span class="p">[:,:,</span><span class="n">dt</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directors_dt</span><span class="p">)</span>
                                                  <span class="p">][</span><span class="o">~</span><span class="n">dt</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">count</span><span class="p">),:</span>
                                                   <span class="p">][:,:,</span><span class="n">dt</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                                                    <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">directors_views_rating_v1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>directed_by</th><th>us_views_millions</th><th>imdb_rating</th><th>count</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>Gary Halvorson</td><td>22.3561</td><td>8.40185</td><td>54</td></tr>
    <tr><td class='row_index'>1</td><td>Kevin S. Bright</td><td>27.3308</td><td>8.6566</td><td>53</td></tr>
    <tr><td class='row_index'>2</td><td>Michael Lembeck</td><td>29.1513</td><td>8.52083</td><td>24</td></tr>
    <tr><td class='row_index'>3</td><td>James Burrows</td><td>24.78</td><td>8.50667</td><td>15</td></tr>
    <tr><td class='row_index'>4</td><td>Gail Mancuso</td><td>25.5214</td><td>8.35714</td><td>14</td></tr>
    <tr><td class='row_index'>5</td><td>Peter Bonerz</td><td>25.0167</td><td>8.325</td><td>12</td></tr>
    <tr><td class='row_index'>6</td><td>David Schwimmer</td><td>24.435</td><td>8.55</td><td>10</td></tr>
    <tr><td class='row_index'>7</td><td>Ben Weiss</td><td>23.788</td><td>8.3</td><td>10</td></tr>
    <tr><td class='row_index'>8</td><td>Shelley Jensen</td><td>25.5667</td><td>8.43333</td><td>6</td></tr>
    <tr><td class='row_index'>9</td><td>Robby Benson</td><td>27.9333</td><td>8.18333</td><td>6</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>10 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">directors_views_rating_v1</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;directed_by&#39;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="s1">&#39;-x&#39;</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;imdb_rating&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Top directors title counts and imdb ratings&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-35d2eaec0dfc4fc992ad869d1589d4af"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-35d2eaec0dfc4fc992ad869d1589d4af") {
      outputDiv = document.getElementById("altair-viz-35d2eaec0dfc4fc992ad869d1589d4af");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-d4ac36c62962e827fee92e7b73200d26"}, "mark": "bar", "encoding": {"color": {"type": "quantitative", "field": "imdb_rating"}, "x": {"type": "quantitative", "field": "count"}, "y": {"type": "nominal", "field": "directed_by", "sort": "-x"}}, "title": "Top directors title counts and imdb ratings", "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-d4ac36c62962e827fee92e7b73200d26": [{"directed_by": "Gary Halvorson", "us_views_millions": 22.35611111111111, "imdb_rating": 8.401851851851852, "count": 54}, {"directed_by": "Kevin S. Bright", "us_views_millions": 27.33075471698114, "imdb_rating": 8.656603773584903, "count": 53}, {"directed_by": "Michael Lembeck", "us_views_millions": 29.151250000000008, "imdb_rating": 8.52083333333333, "count": 24}, {"directed_by": "James Burrows", "us_views_millions": 24.780000000000005, "imdb_rating": 8.506666666666666, "count": 15}, {"directed_by": "Gail Mancuso", "us_views_millions": 25.521428571428565, "imdb_rating": 8.357142857142858, "count": 14}, {"directed_by": "Peter Bonerz", "us_views_millions": 25.016666666666666, "imdb_rating": 8.325000000000001, "count": 12}, {"directed_by": "David Schwimmer", "us_views_millions": 24.435000000000002, "imdb_rating": 8.55, "count": 10}, {"directed_by": "Ben Weiss", "us_views_millions": 23.788, "imdb_rating": 8.3, "count": 10}, {"directed_by": "Shelley Jensen", "us_views_millions": 25.566666666666666, "imdb_rating": 8.433333333333332, "count": 6}, {"directed_by": "Robby Benson", "us_views_millions": 27.933333333333334, "imdb_rating": 8.183333333333334, "count": 6}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">directors_views_rating_v1</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;directed_by&#39;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="s1">&#39;-x&#39;</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;us_views_millions&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Top directors title counts and US million views&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-9f812c2a27264d9b850cc15cea450c5b"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9f812c2a27264d9b850cc15cea450c5b") {
      outputDiv = document.getElementById("altair-viz-9f812c2a27264d9b850cc15cea450c5b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-d4ac36c62962e827fee92e7b73200d26"}, "mark": "bar", "encoding": {"color": {"type": "quantitative", "field": "us_views_millions"}, "x": {"type": "quantitative", "field": "count"}, "y": {"type": "nominal", "field": "directed_by", "sort": "-x"}}, "title": "Top directors title counts and US million views", "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-d4ac36c62962e827fee92e7b73200d26": [{"directed_by": "Gary Halvorson", "us_views_millions": 22.35611111111111, "imdb_rating": 8.401851851851852, "count": 54}, {"directed_by": "Kevin S. Bright", "us_views_millions": 27.33075471698114, "imdb_rating": 8.656603773584903, "count": 53}, {"directed_by": "Michael Lembeck", "us_views_millions": 29.151250000000008, "imdb_rating": 8.52083333333333, "count": 24}, {"directed_by": "James Burrows", "us_views_millions": 24.780000000000005, "imdb_rating": 8.506666666666666, "count": 15}, {"directed_by": "Gail Mancuso", "us_views_millions": 25.521428571428565, "imdb_rating": 8.357142857142858, "count": 14}, {"directed_by": "Peter Bonerz", "us_views_millions": 25.016666666666666, "imdb_rating": 8.325000000000001, "count": 12}, {"directed_by": "David Schwimmer", "us_views_millions": 24.435000000000002, "imdb_rating": 8.55, "count": 10}, {"directed_by": "Ben Weiss", "us_views_millions": 23.788, "imdb_rating": 8.3, "count": 10}, {"directed_by": "Shelley Jensen", "us_views_millions": 25.566666666666666, "imdb_rating": 8.433333333333332, "count": 6}, {"directed_by": "Robby Benson", "us_views_millions": 27.933333333333334, "imdb_rating": 8.183333333333334, "count": 6}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># are the directors and writers same for a title ?</span>
<span class="n">amigos_info_dt</span><span class="p">[:,</span><span class="n">dt</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">temp</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">directed_by</span><span class="o">==</span><span class="n">f</span><span class="o">.</span><span class="n">written_by</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># are the directors and writers same for a title ?</span>
<span class="n">amigos_info_dt</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">temp</span><span class="o">==</span><span class="kc">True</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>episode</th><th>title</th><th>directed_by</th><th>written_by</th><th>air_date</th><th>us_views_millions</th><th>imdb_rating</th><th>temp</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='boolean' title='bool8'>&#x25AA;</td></tr>
  </thead>
  <tbody>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>0 rows &times; 9 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove the temp col</span>
<span class="k">del</span> <span class="n">amigos_info_dt</span><span class="p">[</span><span class="s2">&quot;temp&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># split writers column</span>
<span class="n">writers_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">elemento</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">elemento</span> <span class="ow">in</span> <span class="n">amigos_info_dt</span><span class="p">[:,</span><span class="n">f</span><span class="o">.</span><span class="n">written_by</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a new DT with writers</span>
<span class="n">writers_dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="s1">&#39;no_of_writers&#39;</span><span class="p">:[</span><span class="nb">len</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">writers_list</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Joining two DTs</span>
<span class="n">amigos_info_dt_v1</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">amigos_info_dt</span><span class="p">,</span><span class="n">writers_dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># No of writers </span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">amigos_info_dt_v1</span><span class="p">[:,</span><span class="n">count</span><span class="p">(),</span><span class="n">by</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">no_of_writers</span><span class="p">)]</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>

    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;no_of_writers:O&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of writers in titles&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-7ead00274b7447bdab293878e671d4e6"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7ead00274b7447bdab293878e671d4e6") {
      outputDiv = document.getElementById("altair-viz-7ead00274b7447bdab293878e671d4e6");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-eba9a01631bf4cbbafbc1d39a033d10a"}, "mark": "bar", "encoding": {"x": {"type": "quantitative", "field": "count"}, "y": {"type": "ordinal", "field": "no_of_writers"}}, "title": "Number of writers in titles", "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-eba9a01631bf4cbbafbc1d39a033d10a": [{"no_of_writers": 1, "count": 113}, {"no_of_writers": 2, "count": 104}, {"no_of_writers": 3, "count": 18}, {"no_of_writers": 4, "count": 1}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amigos_year</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="s1">&#39;year&#39;</span><span class="p">:[</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\d]</span><span class="si">{4}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">fecha</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">fecha</span> <span class="ow">in</span> <span class="n">amigos_info_dt_v1</span><span class="p">[:,</span><span class="n">f</span><span class="o">.</span><span class="n">air_date</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">amigos_year</span><span class="p">[:,</span><span class="n">count</span><span class="p">(),</span><span class="n">by</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">year</span><span class="p">)]</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-7cf762536e764acc92e9ed0b46880ed8"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7cf762536e764acc92e9ed0b46880ed8") {
      outputDiv = document.getElementById("altair-viz-7cf762536e764acc92e9ed0b46880ed8");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-115df91c67da845ceb6211e3288eaa6e"}, "mark": "line", "encoding": {"x": {"type": "nominal", "field": "year"}, "y": {"type": "quantitative", "field": "count"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-115df91c67da845ceb6211e3288eaa6e": [{"year": "1994", "count": 10}, {"year": "1995", "count": 23}, {"year": "1996", "count": 25}, {"year": "1997", "count": 25}, {"year": "1998", "count": 24}, {"year": "1999", "count": 24}, {"year": "2000", "count": 25}, {"year": "2001", "count": 25}, {"year": "2002", "count": 23}, {"year": "2003", "count": 22}, {"year": "2004", "count": 10}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amigos_dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>text</th><th>speaker</th><th>season</th><th>episode</th><th>scene</th><th>utterance</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>There's nothing to tell! He's just some guy I work&#133;</td><td>Monica Geller</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
    <tr><td class='row_index'>1</td><td>C'mon, you're going out with the guy! There's gott&#133;</td><td>Joey Tribbiani</td><td>1</td><td>1</td><td>1</td><td>2</td></tr>
    <tr><td class='row_index'>2</td><td>All right Joey, be nice. So does he have a hump? A&#133;</td><td>Chandler Bing</td><td>1</td><td>1</td><td>1</td><td>3</td></tr>
    <tr><td class='row_index'>3</td><td>Wait, does he eat chalk?</td><td>Phoebe Buffay</td><td>1</td><td>1</td><td>1</td><td>4</td></tr>
    <tr><td class='row_index'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td></tr>
    <tr><td class='row_index'>67,369</td><td>Do you guys have to go to the new house right away&#133;</td><td>Rachel Green</td><td>10</td><td>18</td><td>11</td><td>18</td></tr>
    <tr><td class='row_index'>67,370</td><td>We got some time.</td><td>Monica Geller</td><td>10</td><td>18</td><td>11</td><td>19</td></tr>
    <tr><td class='row_index'>67,371</td><td>Okay, should we get some coffee?</td><td>Rachel Green</td><td>10</td><td>18</td><td>11</td><td>20</td></tr>
    <tr><td class='row_index'>67,372</td><td>Sure. Where?</td><td>Chandler Bing</td><td>10</td><td>18</td><td>11</td><td>21</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>67,373 rows &times; 6 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amigos_info_df</span> <span class="o">=</span> <span class="n">amigos_info_dt</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amigos_df</span> <span class="o">=</span> <span class="n">amigos_dt</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amigos_todo_dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span> <span class="n">amigos_info_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">amigos_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;season&#39;</span><span class="p">,</span><span class="s1">&#39;episode&#39;</span><span class="p">]),</span>
                                               <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">,</span><span class="s1">&#39;episode&#39;</span><span class="p">])</span> 
                         <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amigos_todo_dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>episode</th><th>title</th><th>directed_by</th><th>written_by</th><th>air_date</th><th>us_views_millions</th><th>imdb_rating</th><th>text</th><th>speaker</th><th>scene</th><th>utterance</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td><td>There's nothing to tell! He's just some guy I work&#133;</td><td>Monica Geller</td><td>1</td><td>1</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td><td>C'mon, you're going out with the guy! There's gott&#133;</td><td>Joey Tribbiani</td><td>1</td><td>2</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td><td>All right Joey, be nice. So does he have a hump? A&#133;</td><td>Chandler Bing</td><td>1</td><td>3</td></tr>
    <tr><td class='row_index'>3</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td><td>Wait, does he eat chalk?</td><td>Phoebe Buffay</td><td>1</td><td>4</td></tr>
    <tr><td class='row_index'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td></tr>
    <tr><td class='row_index'>67,369</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td><td>Do you guys have to go to the new house right away&#133;</td><td>Rachel Green</td><td>11</td><td>18</td></tr>
    <tr><td class='row_index'>67,370</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td><td>We got some time.</td><td>Monica Geller</td><td>11</td><td>19</td></tr>
    <tr><td class='row_index'>67,371</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td><td>Okay, should we get some coffee?</td><td>Rachel Green</td><td>11</td><td>20</td></tr>
    <tr><td class='row_index'>67,372</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td><td>Sure. Where?</td><td>Chandler Bing</td><td>11</td><td>21</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>67,373 rows &times; 12 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amigos_todo_dt</span><span class="p">[</span><span class="o">~</span><span class="n">dt</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">speaker</span><span class="p">),:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>season</th><th>episode</th><th>title</th><th>directed_by</th><th>written_by</th><th>air_date</th><th>us_views_millions</th><th>imdb_rating</th><th>text</th><th>speaker</th><th>scene</th><th>utterance</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='string' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='integer' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td><td>There's nothing to tell! He's just some guy I work&#133;</td><td>Monica Geller</td><td>1</td><td>1</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td><td>C'mon, you're going out with the guy! There's gott&#133;</td><td>Joey Tribbiani</td><td>1</td><td>2</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td><td>All right Joey, be nice. So does he have a hump? A&#133;</td><td>Chandler Bing</td><td>1</td><td>3</td></tr>
    <tr><td class='row_index'>3</td><td>1</td><td>1</td><td>The Pilot</td><td>James Burrows</td><td>David Crane &amp; Marta Kauffman</td><td>1994-09-22</td><td>21.5</td><td>8.3</td><td>Wait, does he eat chalk?</td><td>Phoebe Buffay</td><td>1</td><td>4</td></tr>
    <tr><td class='row_index'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td></tr>
    <tr><td class='row_index'>67,093</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td><td>Do you guys have to go to the new house right away&#133;</td><td>Rachel Green</td><td>11</td><td>18</td></tr>
    <tr><td class='row_index'>67,094</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td><td>We got some time.</td><td>Monica Geller</td><td>11</td><td>19</td></tr>
    <tr><td class='row_index'>67,095</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td><td>Okay, should we get some coffee?</td><td>Rachel Green</td><td>11</td><td>20</td></tr>
    <tr><td class='row_index'>67,096</td><td>10</td><td>18</td><td>The Last One</td><td>Kevin S. Bright</td><td>Marta Kauffman &amp; David Crane</td><td>2004-05-06</td><td>52.46</td><td>9.7</td><td>Sure. Where?</td><td>Chandler Bing</td><td>11</td><td>21</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>67,097 rows &times; 12 columns</div>
  </div>
</div>
</div></div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="py_dt_global_crop_yields.html" title="previous page">Py : Tidy data analysis - Global Crop Yields</a>
    <a class='right-next' id="next-link" href="python_dt_concepts.html" title="next page">Python references</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sr.Mallesham Yamulla<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>